\mysection{Anexos}

    \subsection{Anexo I: Interfaces de los componentes del \textit{OCDS\_Mapper}} \label{annex:interfaces}
        \subsubsection{Componente \textit{Provider}}
            \begin{lstlisting}[language=lCSharp]
                namespace OCDS_Mapper.src.Interfaces
                {
                    /* Interfaz del componente de provisión de datos */
                
                    public interface IProvider
                    {
                        /* Propiedades */
                
                        /*  propiedad Parser => IParser
                         *      Instancia del Parser para obtener los enlaces de los documentos
                         */
                        IParser Parser { get; set; }
                
                        /*  propiedad Files => AsyncCollection<Document>
                         *      Colección thread-safe que permite una extracción
                         *      ordenada de los documentos provistos
                         */
                        AsyncCollection<Document> Files { get; set; }
                
                
                        /* Funciones */
                
                        /*  función asíncrona TakeFile() => Document
                         *      Función bloqueante que devuelve un documento provisto cuando éste
                         *      está disponible
                         *  @return : stream de texto del documento provisto, o null si no quedan
                         *      más documentos que proveer
                         */
                        Task<Document> TakeFile();
                
                        /*  función SetParser(IParser) => bool
                         *      (utilizada solo en modo PROVIDE_ALL y PROVIDE_DAILY)
                         *      Desbloquea el thread en background que integra al Provider y al Parser
                         *  @param parser : Instancia del Parser para cada documento
                         *  @return : true si el documento del Parser es día anterior al actual,
                         *      false e.o.c
                         */
                        bool SetParser(IParser parser);
                
                        /*  función RemoveFile(string) => void
                         *      Función que elimina un archivo provisto ya mapeado
                         *  @param filePath : path del documento a eliminar
                         */
                        void RemoveFile(string filePath);
                    }
                }
            \end{lstlisting}
\newpage
        \subsubsection{Componente \textit{Parser}}
            \begin{lstlisting}[language=lCSharp]
                namespace OCDS_Mapper.src.Interfaces
                {
                    /* Interfaz del componente de parseo */
                    
                    public interface IParser
                    {
                        /* Propiedades */
                
                        /*  propiedad DocumentRoot => XElement
                         *      Representa el elemento XML raíz del documento atom
                         */
                        XElement DocumentRoot { get; set; }
                
                        /*  propiedad EntryRoot => XElement
                         *      Representa el elemento XML raíz de la entrada siendo parseada:
                         *      @ej : XElement(<cac-place-ext:ContractFolderStatus>)
                         */
                        XElement EntryRoot { get; set; }
                
                
                        /* Funciones */
                
                        /*  función GetNamespaces() => IDictionary<string, XNamespace>
                         *      Representa mediante pares de nombres y espacios de nombres los 
                         *      namespaces del documento
                         *      Recupera dicha información de los atributos del elemento feed en los
                         *      ficheros atom
                         *  @return : Diccionario con los pares de espacios de nombres
                         *      @ej : { {"cac" : XNamespace("...:CommonAggregateComponents-2")}, ... }
                         */
                        IDictionary<string, XNamespace> GetNamespaces();
                
                        /*  función GetEntrySet(IDictionary<string, XNamespace>) => IEnumerable<XElement>
                         *      Devuelve el conjunto de entradas en el fichero atom
                         *      Las entradas vienen definidas por el elemento entry
                         *  @param namespaces : Diccionario de espacios de nombres
                         *  @return : Conjunto de elementos XML
                         *      @ej : [ XElement(<entry xmlns="..."> <id>...</id> ... </entry>), ... ]
                         */
                        IEnumerable<XElement> GetEntrySet(IDictionary<string, XNamespace> namespaces);
                
                        /*  función SetEntryRootElement(XElement) => void
                         *      Actualiza la propiedad del objeto EntryRoot
                         *      Extrae el elemento XML correspondiente a "ContractFolderStatus"
                         *  @throws InvalidParsedElementException : si el elemento no contiene 
                         *      "ContractFolderStatus"
                         */
                        void SetEntryRootElement(XElement entry);
                
                
                
                
                        /*  función GetElements(IEnumerable<XName>) => XElement[]
                         *      Devuelve el (los) elemento(s) XML descrito por la ruta pasada
                         *      como parámetro
                         *  @param pathToElement : lista enlazada con la ruta del elemento deseado:
                         *      @ej : [ XName(XNamespace("cac") + "ProcurementProject"),
                         *              XName(XNamespace("cbc") + "Name") ]
                         *  @return : elemento(s) buscado(s), o null si no se puede encontrar
                         *      @ej : XElement(<cbc:Name>"..."</cbc:Name>)
                         */
                        XElement[] GetElements(IEnumerable<XName> pathToElement);
                
                        /*  función GetNextFile() => Uri
                         *      Devuelve la URI correspondiente al siguiente fichero, descrito por el
                         *      elemento "link" y el atributo "rel=next"
                         *  @return : La URI que describe el fichero enlazado al siendo parseado en
                         *      esta instancia
                         */
                        Uri GetNextFile();
                
                        /*  función GetDocumentTimestamp(bool) => string
                         *      Devuelve el timestamp del documento o de una entrada específica
                         *  @param document : True si se quiere recuperar el timestamp del documento, 
                         *      False si se quiere el de la entrada
                         *  @return : timestamp (o campo "updated") del documento de licitaciones
                         *      o de la entrada
                         */
                        string GetDocumentTimestamp(bool document);
                    }
                }
            \end{lstlisting}
\newpage
        \subsubsection{Componente \textit{Mapper}}
            \begin{lstlisting}[language=lCSharp]
                namespace OCDS_Mapper.src.Interfaces
                {
                    /* Interfaz del componente de mapeo */
                
                    public interface IMapper
                    {
                        /* Propiedades */
                
                        /*  propiedad MappedEntry => JObject
                         *      Representa el elemento JSON con la información mapeada
                         */
                        JObject MappedEntry { get; set; }
                
                
                        /* Funciones */
                
                        /*  función MapElement(IEnumerable<string>, XElement[]) => void
                         *      Realiza el mapeo de elemento(s) CODICE a elemento(s) OCDS
                         *  @param pathMap : ruta del elemento cuando sea mapeado
                         *  @param parsedElement : elemento(s) a mapear
                         *  @ej : MapElement( [ "tender", "title" ], [ "ABCD" ] )
                         *      => MappedEntry = { "tender": { "title": "ABCD" } }
                         *  @ej : MapElement( [ "tag" ], [ "PRE" ] )
                         *      => MappedEntry = { "tag": [ "planning" ] }
                         */
                        void MapElement(IEnumerable<string> pathMap, XElement[] parsedElement);
                
                        /*  función Commit(string) => void
                         *      Introduce los cambios al JSON que no se pueden introducir
                         *      mediante los mapeos unitarios de elementos (metadatos, colecciones, etc.)
                         *  @param publishDate : fecha de publicación de la entrega
                         */
                        void Commit(string publishDate);
                    }
                }
            \end{lstlisting}
\newpage
        \subsubsection{Componente \textit{Packager}}
            \begin{lstlisting}[language=lCSharp]
                namespace OCDS_Mapper.src.Interfaces
                {
                    /* Interfaz del componente de empaquetado de datos  */
                
                    public interface IPackager
                    {
                        /* Funciones */
                
                        /*  función GetIdentifier(string) => string
                         *      Obtiene el número de ocurrencias del identificador hasta el momento
                         *      con el objetivo de evitar colisiones de ids no únicos
                         *  @param entryID : identificador de la entrada
                         *  @return : número de ocurrencias del identificador
                         */
                        string GetIdentifier(string entryID);
                
                        /*  función Package(JObject) => void
                         *      Introduce una entrada al paquete
                         *  @param entry : objeto JSON que introducir
                         */
                        void Package(JObject entry);
                
                        /*  función Publish(string) => void
                         *      Publica los datos escribiéndolos en el directorio de salida
                         *  @param dirPath : path del directorio de salida
                         */
                        void Publish(string dirPath);
                    }
                }
            \end{lstlisting}
            
\newpage

    \subsection{Anexo II: Ejemplos de los mapeados entre \texttt{CODICE} y \texttt{OCDS}} \label{annex:correspondencias}

        \subsubsection{Datos generales del expediente}
            \paragraph{Estado} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cbc-place-ext:ContractFolderStatusCode languageID="es"
                         listURI="https://contrataciondelestado.es/codice/cl/2.04/
                         SyndicationContractFolderStatusCode-2.04.gc">
                            ADJ
                        </cbc-place-ext:ContractFolderStatusCode>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tag": [
                            "award"
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Número de expediente} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cbc:ContractFolderID>
                            002/2021-CONTR
                        </cbc:ContractFolderID>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "ocid": "<OCDS-PREFIX>-002/2021-CONTR"
                    }
                \end{lstlisting}
                
            \paragraph{Objeto del contrato} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProject>
                            <cbc:Name>
                                Suministro de energía eléctrica para las instalaciones de RTVE
                            </cbc:Name>
                        </cac:ProcurementProject>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "title": "Suministro de energía eléctrica para las instalaciones de RTVE"
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Valor estimado e importe de licitación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProject>
                            <cac:BudgetAmount>
                                <cbc:EstimatedOverallContractAmount currencyID="EUR">
                                    185000
                                </cbc:EstimatedOverallContractAmount>
                                <cbc:TotalAmount currencyID="EUR">
                                    120000
                                </cbc:TotalAmount>
                            </cac:BudgetAmount>
                        </cac:ProcurementProject>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "value": {
                                "amount": 185000,
                                "currency": "EUR"
                            }
                        } ,
                        "planning": {
                            "budget": {
                                "amount": {
                                    "amount": 120000,
                                    "currency": "EUR"
                                }
                            }
                        }
                    }
                \end{lstlisting}
\newpage
            \paragraph{Duración del contrato} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProject>
                            <cac:PlannedPeriod>
                                <cbc:StartDate>
                                    2021-09-01
                                </cbc:StartDate>
                                <cbc:EndDate>
                                    2021-12-01
                                </cbc:EndDate>
                            </cac:PlannedPeriod>
                        </cac:ProcurementProject>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "tenderPeriod": {
                                "startDate": "2021-09-01T00:00:00Z",
                                "endDate": "2021-12-01T00:00:00Z"
                            }
                        }
                    }
                \end{lstlisting}
                
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProject>
                            <cac:PlannedPeriod>
                                <cbc:DurationMeasure unitCode="MON">
                                    3
                                </cbc:DurationMeasure>
                            </cac:PlannedPeriod>
                        </cac:ProcurementProject>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "tenderPeriod": {
                                "durationInDays": 90
                            }
                        }
                    }
                \end{lstlisting}
            
            \paragraph{Tipo de contrato} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProject>
                            <cbc:TypeCode
                             listURI="https://contrataciondelestado.es/codice/cl/2.08/
                             ContractCode-2.08.gc">
                                2
                            </cbc:TypeCode>
                        </cac:ProcurementProject>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "mainProcurementCategory": "services"
                        }
                    }
                \end{lstlisting}
\newpage
        \subsubsection{Lotes y artículos}
            \paragraph{Número de lote} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProjectLot>
                            <cbc:ID>
                                5
                            </cbc:ID>
                        </cac:ProcurementProjectLot>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "lots": [
                                {
                                    "id": "lot-5"
                                }
                            ],
                            "items": [
                                {
                                    "id": "5",
                                    "relatedLot": "lot-5"
                                }
                            ]
                        }
                    }
                \end{lstlisting}
\newpage
            \paragraph{Objeto del lote} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProjectLot>
                            <cac:ProcurementProject>
                                <cbc:Name>
                                    Equipos respiratorios autónomos
                                </cbc:Name>
                            </cac:ProcurementProject>
                        </cac:ProcurementProjectLot>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "lots": [
                                {
                                    "name": "Equipos respiratorios autónomos"
                                }
                            ]
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Importe del lote} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProjectLot>
                            <cac:ProcurementProject>
                                <cac:BudgetAmount>
                                    <cbc:TotalAmount>
                                        2250
                                    </cbc:TotalAmount>
                                </cac:BudgetAmount>
                            <cac:ProcurementProject>
                        </cac:ProcurementProjectLot>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "lots": [
                                {
                                    "value": {
                                        "value": 2250.0,
                                        "currency": "EUR"
                                    }
                                }
                            ]
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Clasificación \texttt{CPV}} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:ProcurementProjectLot>
                            <cac:ProcurementProject>
                                <cbc:RequiredCommodityClassification>
                                    <cbc:ItemClassificationCode 
                                    listURI="http://contrataciondelestado.es/codice/cl/1.04/
                                    CPV2007-1.04.gc">
                                        35111100
                                    </cbc:ItemClassificationCode>
                                </cbc:RequiredCommodityClassification>
                            </cac:ProcurementProject>
                        </cac:ProcurementProjectLot>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "items": [
                                {
                                    "classification": {
                                        "id": "35111100",
                                        "schema": "CPV",
                                        "description_es": "Aparatos respiratorios para extinción de incendios."
                                    }
                                }
                            ]
                        }
                    }
                \end{lstlisting}
                
        \subsubsection{Procesos de licitación}
            \paragraph{Tipo de procedimiento} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderingProcess>
                            <cbc:ProcedureCode
                             listURI="https://contrataciondelestado.es/codice/cl/2.07/
                             SyndicationTenderingProcessCode-2.07.gc">
                                9
                            </cbc:ProcedureCode>
                        </cac:TenderingProcess>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "procurementMethod": "open"
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Sistema de contratación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderingProcess>
                            <cbc:ContractingSystemCode
                             listURI="https://contrataciondelestado.es/codice/cl/2.08/
                             ContractingSystemTypeCode-2.08.gc">
                                3
                            </cbc:ContractingSystemCode>
                        </cac:TenderingProcess>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "procurementMethodDetails_es": "Contrato basado en un Acuerdo Marco"
                        }
                    }
                \end{lstlisting}
\newpage
            \paragraph{Presentación de la oferta} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderingProcess>
                            <cbc:SubmissionMethodCode
                             listURI="https://contrataciondelestado.es/codice/cl/1.04/
                             TenderDeliveryCode-1.04.gc">
                                1
                            </cbc:SubmissionMethodCode>
                        </cac:TenderingProcess>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "submissionMethod": [
                                "electronicSubmission"
                            ]
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Idioma de presentación de la oferta} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderingTerms>
                            <cac:Language>
                                <cbc:ID>
                                    es
                                </cbc:ID>
                            </cac:Language>
                            <cac:Language>
                                <cbc:ID>
                                    ca
                                </cbc:ID>
                            </cac:Language>
                        </cac:TenderingTerms>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "submissionMethodDetails": "Languages: es, ca"
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Licitación son subasta electrónica} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderingProcess>
                            <cac:AuctionTerms>
                                <cbc:AuctionConstraintIndicator>
                                    true
                                </cbc:AuctionConstraintIndicator>
                            </cac:AuctionTerms>
                        </cac:TenderingProcess>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "submissionMethod": [
                                "electronicAuction"
                            ]
                        }
                    }
                \end{lstlisting}
        
        \subsubsection{Entidades adjudicadoras}
            \paragraph{Órgano de contratación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac-place-ext:LocatedContractingParty>
                            <cac:Party>
                                <cac:PartyName>
                                    <cbc:Name>
                                        Junta de Gobierno del Ayuntamiento de Orihuela
                                    </cbc:Name>
                                </cac:PartyName>
                            </cac:Party>
                        </cac-place-ext:LocatedContractingParty>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "parties": [
                            {
                                "name": "Junta de Gobierno del Ayuntamiento de Orihuela"
                            }
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Ubicación orgánica} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac-place-ext:LocatedContractingParty>
                            <cac:Party>
                                <cac:PartyIdentification>
                                    <cbc:ID schemeName="DIR3">
                                        L01030993
                                    </cbc:ID>
                                </cac:PartyIdentification>
                                <cac:PartyIdentification>
                                    <cbc:ID schemeName="NIF">
                                        P0309900I
                                    </cbc:ID>
                                </cac:PartyIdentification>
                            </cac:Party>
                        </cac-place-ext:LocatedContractingParty>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "parties": [
                            {
                                "identifier": {
                                    "scheme": "ES-DIR3",
                                    "id": "L01030993",
                                    "additionalIdentifiers": [
                                        {
                                            "scheme": "ES-RMC",
                                            "id": "P0309900I"
                                        }
                                    ]
                                } ,
                                "id": "L01030993",
                                "roles": [
                                    "procuringEntity"
                                ]
                            }
                        ]
                    }
                \end{lstlisting}
\newpage
            \paragraph{Otros campos} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac-place-ext:LocatedContractingParty>
                            <cac:Party>
                                <cbc:WebsiteURI>
                                    http://www.orihuela.es/
                                </cbc:WebsiteURI>
                                <cac:PostalAddress>
                                    <cbc:CityName>
                                        Orihuela
                                    </cbc:CityName>
                                    <cbc:PostalZone>
                                        03300
                                    </cbc:PostalZone>
                                    <cac:AddressLine>
                                        <cbc:Line>
                                            Marqués de Arneva, 1
                                        </cbc:Line>
                                    </cac:AddressLine>
                                    <cac:Country>
                                        <cbc:IdentificationCode
                                        listURI="http://docs.oasis-open.org/ubl/os-ubl-2.0/
                                        cl/gc/default/CountryIdentificationCode-2.0.gc">
                                            ES
                                        </cbc:IdentificationCode>
                                    </cac:Country>
                                </cac:PostalAddress>
                                <cac:Contact>
                                    <cbc:Name>
                                        Junta de Gobierno del Ayuntamiento de Orihuela
                                    </cbc:Name>
                                    <cbc:Telephone>
                                        966076100
                                    </cbc:Telephone>
                                    <cbc:Telefax>
                                        966076101
                                    </cbc:Telefax>
                                    <cbc:ElectronicMail>
                                        contratacion@orihuela.es
                                    </cbc:ElectronicMail>
                                </cac:Contact>
                            </cac:Party>
                        </cac-place-ext:LocatedContractingParty>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "parties": [
                            {
                                "countryName": "ES",
                                "address": {
                                    "streetAddress": "Marqués de Arneva, 1",
                                    "locality": "Orihuela",
                                    "postalCode": "03300"
                                },
                                "contactPoint": {
                                    "email": "contratacion@orihuela.es",
                                    "faxNumber": "966076101",
                                    "name": "Junta de Gobierno del Ayuntamiento de Orihuela",
                                    "telephone": "966076100",
                                    "url": "http://www.orihuela.es/"
                                }
                            }
                        ]
                    }
                \end{lstlisting}
            
        \subsubsection{Resultado del procedimiento}
            \paragraph{Identificador} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cac:AwardedTenderedProject>
                                <cbc:ProcurementProjectLotID>
                                    1
                                </cbc:ProcurementProjectLotID>
                            </cac:AwardedTenderedProject>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "id": "<OCDS-PREFIX>-<ID>-1"
                            }
                        ]
                    }
                \end{lstlisting}
\newpage
            \paragraph{Resultado} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cac:ResultCode
                            listURI="http://contrataciondelestado.es/codice/cl/2.02/
                            TenderResultCode-2.02.gc">
                                8
                            </cac:ResultCode>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "status": "active"
                            }
                        ]
                    }
                \end{lstlisting}
            
            \paragraph{Identidad del adjudicatario} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cac:WinningParty>
                                <cac:PartyIdentification>
                                    <cbc:ID schemeName="NIF">
                                        B37012515
                                    </cbc:ID>
                                </cac:PartyIdentification>
                                <cac:PartyName>
                                    <cbc:Name>
                                        AGRUPESCA, S.L.
                                    </cbc:Name>
                                </cac:PartyName>
                            </cac:WinningParty>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "suppliers": [
                                    {
                                        "id": "B37012515",
                                        "name": "AGRUPESCA, S.L."
                                    }
                                ]
                            }
                        ],
                        "parties": [
                            {
                                "identifier": {
                                    "scheme": "ES-RMC",
                                    "id": "B37012515"
                                },
                                "id": "B37012515",
                                "name": "AGRUPESCA, S.L.",
                                "roles": [
                                    "supplier"
                                ]
                            }
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Importe de adjudicación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cac:AwardedTenderedProject>
                                <cac:LegalMonetaryTotal>
                                    <cbc:PayableAmount currencyID="EUR">
                                        18260.5
                                    </cbc:PayableAmount>
                                </cac:LegalMonetaryTotal>
                            </cac:AwardedTenderedProject>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "value": {
                                    "amount": 18260.5,
                                    "currency": "EUR"
                                }
                            }
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Número de licitadores participantes} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cbc:ReceivedTenderQuantity>
                                5
                            </cbc:ReceivedTenderQuantity>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "tender": {
                            "numberOfTenderers: 5
                        }
                    }
                \end{lstlisting}
                
            \paragraph{Fecha de la adjudicación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cbc:AwardDate>
                                2021-04-15
                            </cbc:AwardDate>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "date": "2021-04-15T00:00:00Z"
                            }
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Descripción de la adjudicación} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cbc:Description>
                                Mejor oferta
                            </cbc:Description>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "awards": [
                            {
                                "description_es": "Mejor oferta"
                            }
                        ]
                    }
                \end{lstlisting}
                
        \subsubsection{Información sobre el contrato}
            \paragraph{Identificador} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cac:Contract>
                                <cbc:ID>
                                    1
                                </cbc:ID>
                            </cac:Contract>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
\newpage
                \begin{lstlisting}[language=lJSON]
                    {
                        "contracts": [
                            {
                                "id": "<OCDS-PREFIX>-<ID>-1"
                            }
                        ]
                    }
                \end{lstlisting}
                
            \paragraph{Fecha de entrada en vigor} \mbox{}\\
                \begin{lstlisting}[language=lXML]
                    <cac-place-ext:ContractFolderStatus>
                        <cac:TenderResult>
                            <cbc:StartDate>
                                2021-04-01
                            </cbc:StartDate>
                        </cac:TenderResult>
                    </cac-place-ext:ContractFolderStatus>
                \end{lstlisting}
                
                \begin{center}
                    $\big\Downarrow$
                \end{center}
                
                \begin{lstlisting}[language=lJSON]
                    {
                        "contracts": [
                            {
                                "period": {
                                    "startDate": "2021-04-01T00:00:00Z"
                                }
                            }
                        ]
                    }
                \end{lstlisting}

\newpage

    \subsection{Anexo III: Consultas \texttt{SPARQL} sobre los datos enlazados} \label{annex:sparql}
        \subsubsection{Prefijos de los espacios de nombres utilizados}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    @prefix dc:       <http://purl.org/dc/terms/> .
                    @prefix ocds:     <http://data.tbfy.eu/ontology/ocds#> .
                    @prefix ocdsext:  <http://data.tbfy.eu/ontology/ocds_extension#> .
                    @prefix org:      <http://www.w3.org/ns/org#> .
                    @prefix rdf:      <http://www.w3.org/TR/rdf-schema/> .
                    @prefix schema:   <http://schema.org/> .
                    @prefix skos:     <http://www.w3.org/2004/02/skos/core#> .
                    @prefix tbfy:     <http://data.tbfy.eu/ontology/tbfy#> .
                \end{lstlisting}
            \end{minipage}
            
        \subsubsection{Consulta para la búsqueda de \textit{releases}}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?date ?id ?tag
                    WHERE {
                        ?release a tbfy:Release .
                        ?release tbfy:releaseDate ?date .
                        ?release tbfy:releaseId ?id .
                        ?release tbfy:releaseTag ?tag .
                    }
                \end{lstlisting}
            \end{minipage}
        
        \subsubsection{Consulta para la búsqueda de procesos de contratación}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?ocid ?award ?contract ?plan ?release ?tender
                    WHERE {
                            ?contractingProcess a ocds:ContractingProcess .
                            ?contractingProcess ocds:ocid ?ocid .
                            OPTIONAL {
                                ?contractingProcess ocds:hasAward ?award 
                            } .
                            OPTIONAL {
                                ?contractingProcess ocds:hasContract ?contract
                            } .
                            OPTIONAL {
                                ?contractingProcess ocds:hasPlan ?plan
                            } .
                            OPTIONAL {
                                ?contractingProcess ocds:hasRelease ?release
                            } .
                            OPTIONAL {
                                ?contractingProcess ocds:hasTender ?tender
                            } .
                    }
                \end{lstlisting}
            \end{minipage}

        \subsubsection{Consulta para la búsqueda de adjudicaciones}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?awardId ?tender ?awardDate ?awardStatus ?awardDescription ?awardAmount
                           ?awardCurrency ?awardSupplier ?supplierName ?supplierId
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?contractingProcess ocds:hasAward ?award .
                        ?award ocds:awardId ?awardId .
                        ?award ocds:isIssuedForTender ?tender .
                        ?award ocds:awardDate ?awardDate .
                        ?award ocds:awardStatus ?awardStatus .
                        OPTIONAL {
                            ?award dc:description ?awardDescription
                        } .
                        OPTIONAL {
                            ?award ocds:hasAwardValue ?awardValue
                            OPTIONAL {
                                ?awardValue ocds:valueAmount ?awardAmount .
                                ?awardValue ocds:valueCurrency ?awardCurrency .
                            } .
                        } .
                        OPTIONAL {
                            ?awardSupplier ocds:isSupplierFor ?award
                            OPTIONAL {
                                OPTIONAL {
                                    ?awardSupplier ocds:legalName ?supplierName
                                } .
                                OPTIONAL {
                                    ?awardSupplier org:identifier ?supplierId
                                } .
                            } .
                        } .
                    }
                \end{lstlisting}
            \end{minipage}

        \subsubsection{Consulta para la búsqueda de contratos}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?contractId ?award ?contractStartDate ?contractEndDate
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?contractingProcess ocds:hasContract ?contract .
                        ?contract ocds:contractId ?contractId .
                        ?contract ocds:isIssuedForAward ?award .
                        OPTIONAL {
                            ?contract ocds:hasContractPeriod ?contractPeriod
                            OPTIONAL {
                                OPTIONAL {
                                    ?contractPeriod ocds:periodStartDate ?contractStartDate
                                } .
                                OPTIONAL {
                                    ?contractPeriod ocds:periodEndDate ?contractEndDate
                                } .
                            } .
                        } .
                    }
                \end{lstlisting}
            \end{minipage}
            
        \subsubsection{Consulta para la búsqueda de planificaciones}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?plan ?planBudgetAmount ?planBudgetCurrency
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?contractingProcess ocds:hasPlan ?plan .
                        ?plan ocds:hasBudget ?planBudget .
                        ?planBudget ocds:budgetId ?planBudgetId .
                        ?planBudget ocds:hasReservedValue ?planBudgetValue .
                        ?planBudgetValue ocds:valueAmount ?planBudgetAmount .
                        ?planBudgetValue ocds:valueCurrency ?planBudgetCurrency .
                    }
                \end{lstlisting}
            \end{minipage}
            
        \subsubsection{Consulta para la búsqueda de licitaciones}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?tenderId ?tenderTitle ?tenderProcCategory ?tenderProcMethod
                           ?tenderProcMethodDetails ?tenderSubMethod ?tenderSubMethodDetails 
                           ?tenderTenderers ?tenderValue ?tenderAmount ?tenderCurrency
                           ?tenderPeriod ?tenderPeriodStartDate 
                           ?tenderPeriodEndDate ?tenderPeriodDurationInDays
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?contractingProcess ocds:hasTender ?tender .
                        ?tender ocds:tenderId ?tenderId .
                        ?tender dc:title ?tenderTitle .
                        OPTIONAL {
                            ?tender ocds:mainProcurementCategory ?tenderProcCategory
                        } .
                        OPTIONAL {
                            ?tender ocds:procurementMethod ?tenderProcMethod
                        } .
                        OPTIONAL {
                            ?tender ocds:procurementMethodDetails ?tenderProcMethodDetails
                        } .
                        OPTIONAL {
                            ?tender ocds:submissionMethod ?tenderSubMethod
                        } .
                        OPTIONAL {
                            ?tender ocds:submissionMethodDetails ?tenderSubMethodDetails
                        } .
                        OPTIONAL {
                            ?tender ocds:numberOfTenderers ?tenderTenderers
                        } .
                        OPTIONAL {
                            ?tender ocds:hasMaxEstimatedValue ?tenderValue .
                            ?tenderValue ocds:valueAmount ?tenderAmount .
                            ?tenderValue ocds:valueCurrency ?tenderCurrency .
                        } .
                        OPTIONAL {
                            ?tender ocds:hasTenderPeriod ?tenderPeriod
                            OPTIONAL {
                                OPTIONAL {
                                    ?tenderPeriod ocds:periodStartDate ?tenderPeriodStartDate
                                } .
                                OPTIONAL {
                                    ?tenderPeriod ocds:periodEndDate ?tenderPeriodEndDate
                                } .
                                OPTIONAL {
                                    ?tenderPeriod ocds:periodDurationInDays ?tenderPeriodDurationInDays
                                } .
                            } .
                        } .
                    }
                \end{lstlisting}
            \end{minipage}
            
        \subsubsection{Consulta para la búsqueda de artículos y lotes de licitaciones}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?tenderId ?tenderItem ?tenderItemClassification ?tenderItemScheme 
                           ?tenderItemDescription ?tenderLot ?tenderLotTitle ?tenderLotValue 
                           ?tenderLotAmount ?tenderLotCurrency
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?contractingProcess ocds:hasTender ?tender .
                        ?tender ocds:tenderId ?tenderId .
                        ?tender ocds:hasItemToBeProcured ?tenderItem .
                        ?tenderItem ocds:hasClassification ?tenderItemClassification .
                        ?tenderItem ocds:classificationScheme ?tenderItemScheme .
                        ?tenderItem dc:description ?tenderItemDescription .
                        ?tenderItem ocdsext:relatedLot ?tenderLot .
                        ?tenderLot ocdsext:lotId ?tenderLotId .
                        ?tenderLot dc:title ?tenderLotTitle .
                        OPTIONAL {
                            ?tenderLot ocdsext:hasLotValue ?tenderLotValue .
                            ?tenderLotValue ocds:valueAmount ?tenderLotAmount .
                            ?tenderLotValue ocds:valueCurrency ?tenderLotCurrency .
                        } .
                    }
                \end{lstlisting}
            \end{minipage}
            
        \subsubsection{Consulta para la búsqueda de organizaciones involucradas}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lSPARQL]
                    SELECT ?party ?partyName ?partyId ?partyIdScheme ?partyAddress
                           ?partyAddressCountry ?partyAddressLocality ?partyAddressPostalCode 
                           ?partyAddressStreet ?partyContact ?partyContactEmail
                           ?partyContactName ?partyContactFax ?partyContactTelephone 
                           ?partyContactUrl
                    WHERE {
                        ?contractingProcess a ocds:ContractingProcess .
                        ?party ocds:playsRoleIn ?contractingProcess .
                        ?party ocds:legalName ?partyName .
                        ?party org:identifier ?partyId .
                        OPTIONAL {
                            ?party skos:notation ?partyIdScheme .
                        } .
                        OPTIONAL {
                            ?party ocds:hasAddress ?partyAddress .
                            OPTIONAL {
                                ?partyAddress schema:addressCountry ?partyAddressCountry
                            } .
                            OPTIONAL {
                                ?partyAddress schema:addressLocality ?partyAddressLocality
                            } .
                            OPTIONAL {
                                ?partyAddress schema:postalCode ?partyAddressPostalCode
                            } .
                            OPTIONAL {
                                ?partyAddress schema:streetAddress ?partyAddressStreet
                            } .
                        } .
                        OPTIONAL {
                            ?party ocds:hasContactPoint ?partyContact .
                            OPTIONAL {
                                ?partyContact schema:email ?partyContactEmail
                            } .
                            OPTIONAL {
                                ?partyContact schema:name ?partyContactName
                            } .
                            OPTIONAL {
                                ?partyContact schema:faxNumber ?partyContactFax
                            } .
                            OPTIONAL {
                                ?partyContact schema:telephone ?partyContactTelephone
                            } .
                            OPTIONAL {
                                ?partyContact schema:URL ?partyContactUrl
                            } .
                        } .
                    }
                \end{lstlisting}
            \end{minipage}
            
    \subsection{Anexo IV: \textit{Scripts} \texttt{Python} para la generación y explotación de datos enlazados} \label{annex:scriptspy}
        \subsubsection{\textit{Script} de generación de datos} \label{subsubsec:py1}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                    ################################################################
                    ## generate_rdf.py
                    ##   Script for RDF data generation from JSON sources
                    ##   Stores in ./rdf folder the data generated
                    ##   Uses Node.js module RocketRML to process data
                    ##   Usage: ./python3 generate_rdf.py <dir>
                    ##       <dir> : directory with JSON files to be processed
                    ################################################################
                    ## This script is part of the Final Degree Project:
                    ## "Transformación de los datos de licitaciones de la Plataforma
                    ##  de Contratación Pública al estándar OCDS y su publicación
                    ##  como datos enlazados"
                    ################################################################
                    
                    #########
                    # Imports
                    #########
                    
                    import io
                    import logging
                    import json
                    import os
                    import pathlib
                    import re
                    import subprocess
                    import sys
                    import xmltodict
                    
                    ###########
                    # Functions
                    ###########
                    
                    def get_json_files(directory:pathlib.Path):
                        '''
                            function get_json_files() -> dict<str, io.TextIOWrapper>
                                @param directory    : directory to search json files into
                                @return             : mapping between json filenames and their text streams
                        '''
                    
                        json_files = {}
                        for path in directory.iterdir():
                            if path.is_file() and path.suffix == '.json':
                                json_files[path.name.replace('.json', '')] = open(path, 'r')
                            # END IF
                        # END FOR
                    
                        return json_files
                    # END FUNCTION
                \end{lstlisting}
            \end{minipage}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                    def json_to_xml(json_file:io.TextIOWrapper):
                        '''
                            function json_to_xml() -> str
                                @param json_file    : json file text stream
                                @return             : filename of XML temporary file to be removed
                        '''
                    
                        json_data = json.loads(json_file.read())
                        json_data = { 'root' : json_data }
                    
                        xml_data = xmltodict.unparse(json_data, pretty=True)
                        xml_data = re.compile(u'[\x00-\x08\x0b-\x1f\x7f-\x84\x86-\x9f\ud800-
                                              \udfff\ufdd0-\ufddf\ufffe-\uffff]').sub('', xml_data)
                    
                        xml_filename = 'input.xml'
                        xml_file = open(xml_filename, 'w+', encoding='utf8', errors='ignore')
                        xml_file.write(xml_data)
                    
                        json_file.close()
                        xml_file.close()
                    
                        return xml_filename
                    # END FUNCTION
                    
                    
                    ############
                    # Entrypoint
                    ############
                    
                    if __name__ == '__main__':
                    
                        logger = logging.getLogger()
                        logging.basicConfig(level=logging.INFO)
                    
                        if len(sys.argv) != 2:
                            logger.error('Please provide an argument describing input directory')
                            logger.info('Usage: python3 generate_rdf.py <dir>')
                            exit(1)
                        # END IF
                    
                        input_directory = sys.argv[1]
                        if not os.path.isdir(input_directory):
                            logger.error('Please provide a valid input directory')
                            logger.info('Usage: python3 generate_rdf.py <dir>')
                            exit(1)
                        # END IF
                        
                        json_files = get_json_files(pathlib.Path(input_directory))
                        if len(json_files) == 0:
                            logger.error('Directory provided didnt contain json documents to process')
                            exit(2)
                        # END IF
                \end{lstlisting}
            \end{minipage}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                        json_files = get_json_files(pathlib.Path(input_directory))
                        if len(json_files) == 0:
                            logger.error('Directory provided didnt contain json documents to process')
                            exit(2)
                        # END IF
                    
                        for json_filename, json_filecontent in json_files.items():
                            xml_filename = json_to_xml(json_filecontent)
                            return_code = subprocess.call('node index.js %s' % json_filename, shell=True)
                    
                            if return_code == 0:
                                logger.info('File %s processed, RDF data generated at %s' %
                                            ('%s.json' % json_filename, './rdf/%s.n3' % json_filename))
                                os.remove(xml_filename)
                            else:
                                logger.error('An error occurred while executing Node.js RocketRML application')
                                exit(3)
                            # END IF-ELSE
                        # END FOR
                        
                        exit(0)
                    # END MAIN
                \end{lstlisting}
            \end{minipage}
    
        \subsubsection{\textit{Script} de explotación de datos} \label{subsubsec:py2}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                    ################################################################
                    ## sparql.py
                    ##   Script for SPARQL queries' battery execution
                    ##   Stores in ./queries folder the data extracted from queries
                    ##   Usage: ./python3 sparql.py <dir>
                    ##       <dir> : directory with RDF data to be queried
                    ################################################################
                    ## This script is part of the Final Degree Project:
                    ## "Transformación de los datos de licitaciones de la Plataforma
                    ##  de Contratación Pública al estándar OCDS y su publicación
                    ##  como datos enlazados"
                    ################################################################
                    
                    #########
                    # Imports
                    #########
                    
                    import io
                    import logging
                    import os
                    import pathlib
                    import rdflib
                    import rdflib.plugins.sparql as sparql
                    import sys
                    
                    ###################
                    # Data initializing
                    ###################
                    
                    graph = rdflib.Graph()
                    
                    DC = rdflib.Namespace('http://purl.org/dc/terms/')
                    OCDS = rdflib.Namespace('http://data.tbfy.eu/ontology/ocds#')
                    OCDSEXT = rdflib.Namespace('http://data.tbfy.eu/ontology/ocds_extension#')
                    ORG = rdflib.Namespace('http://www.w3.org/ns/org#')
                    SCHEMA = rdflib.Namespace('http://schema.org/')
                    SKOS = rdflib.Namespace('http://www.w3.org/2004/02/skos/core#')
                    TBFY = rdflib.Namespace('http://data.tbfy.eu/ontology/tbfy#')
                    
                    logger = logging.getLogger('generate_rdf')
                    logging.basicConfig(level=logging.INFO)
                \end{lstlisting}
            \end{minipage}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                    #########
                    # Queries
                    #########
                    
                    # descritas en la sección 10.3 de esta memoria
                    
                    q1 = sparql.prepareQuery('''  
                    ... ''')
                    q2 = sparql.prepareQuery('''
                    ... ''')
                    q3 = sparql.prepareQuery('''
                    ... ''')
                    q4 = sparql.prepareQuery('''
                    ... ''')
                    q5 = sparql.prepareQuery('''
                    ... ''')
                    q6 = sparql.prepareQuery('''
                    ... ''')
                    q7 = sparql.prepareQuery('''
                    ... ''')
                    q8 = sparql.prepareQuery('''
                    ... ''')
                    
                    #################
                    # Query execution
                    #################
                    
                    def execute_query(index:int, output_file:io.TextIOWrapper,
                                      input_query:sparql.parser.Query):
                        '''
                            function execute_query() -> None
                                @param index        : index of query being processed
                                @param output_file  : file to store query results into
                                @param input_query  : query object to execute
                        '''
                    
                        rows = graph.query(input_query)
                    
                        if index == 1:   ...   # q1
                        elif index == 2: ...   # q2
                        elif index == 3: ...   # q3
                        elif index == 4: ...   # q4
                        elif index == 5: ...   # q5
                        elif index == 6: ...   # q6
                        elif index == 7: ...   # q7
                        elif index == 8: ...   # q8
                        # END IF-ELIF
                    # END FUNCTION
                \end{lstlisting}
            \end{minipage}
            \begin{minipage}{\linewidth}
                \begin{lstlisting}[language=lPython]
                    ############
                    # Entrypoint
                    ############
                    
                    if __name__ == '__main__':
                    
                        if len(sys.argv) != 2:
                            logger.error('Please provide an argument describing input directory')
                            logger.info('Usage: python3 sparql.py <dir>')
                            exit(1)
                        # END IF
                    
                        input_directory = sys.argv[1]
                        if not os.path.isdir(input_directory):
                            logger.error('Please provide a valid input directory')
                            logger.info('Usage: python3 sparql.py <dir>')
                            exit(1)
                        # END IF
                    
                        logger.info('RDF data loading')
                        for path in pathlib.Path(input_directory).iterdir():
                            if path.is_file() and path.suffix == '.n3':
                                file = open(path, 'r')
                                graph.parse(file, format='n3')
                                file.close()
                                logger.info('Merged RDF data (%s) into process graph' % file.name)
                            # END IF
                        # END FOR
                    
                        output_files = [
                            open('./queries/1-releases.txt', 'w'),
                            open('./queries/2-contractingProcesses.txt', 'w'),
                            open('./queries/3-awards.txt', 'w'),
                            open('./queries/4-contracts.txt', 'w'),
                            open('./queries/5-plannings.txt', 'w'),
                            open('./queries/6-tenders.txt', 'w'),
                            open('./queries/7-tendersItemsLots.txt', 'w'),
                            open('./queries/8-parties.txt', 'w')
                        ]
                    
                        queries = [q1, q2, q3, q4, q5, q6, q7, q8]
                    
                        for index, (output_file, input_query) in enumerate(zip(output_files, queries)):
                            execute_query(index + 1, output_file, input_query)
                            output_file.close()
                        # END FOR
                        
                        logger.info('Queries execution finished')
                        exit(0)
                    # END MAIN
                \end{lstlisting}
            \end{minipage}
